<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Visualize Wrench &#8212; pytransform3d 3.6.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css?v=3b405b93" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <script src="../../_static/documentation_options.js?v=5349f462"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Probabilistic Product of Exponentials" href="vis_probabilistic_robot_kinematics.html" />
    <link rel="prev" title="URDF Joints" href="vis_urdf.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          pytransform3d</a>
        <span class="navbar-text navbar-version pull-left"><b>3.6.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../index.html">Contents</a></li>
                <li><a href="../index.html">Examples</a></li>
                <li><a href="../../api.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction to 3D Rigid Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rotations.html">SO(3): 3D Rotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../transformations.html">SE(3): 3D Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../transformation_ambiguities.html">Transformation Ambiguities and Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../euler_angles.html">Euler Angles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../transformation_modeling.html">Modeling Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../transform_manager.html">Managing Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../transformation_over_time.html">Managing Transformations over Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../camera.html">Camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../animations.html">Animations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Visualize Wrench</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-visualizations-vis-ee-wrench-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="visualize-wrench">
<span id="sphx-glr-auto-examples-visualizations-vis-ee-wrench-py"></span><h1>Visualize Wrench<a class="headerlink" href="#visualize-wrench" title="Link to this heading">¶</a></h1>
<p>We see a 6-DOF robot arm, and we assume that we have a force/torque sensor
that measures the force of a spherical mass (gray sphere) at the tool center
point (TCP). We can draw the screw representation of the wrench in the TCP
frame as a force along a screw axis from the red sphere to the green sphere.
Then we use the adjoint representation of the transformation from the base
to the TCP to transform the wrench to the robot’s base frame. This wrench
has a force component and a torque component, which we can also visualize
as a screw: the red sphere indicates the point q on the screw axis, the
straight black line shows the screw axis, the red line indicates the
direction to the initial configuration and the green line indicates the
direction to the displaced configuration in which the instantaneous
wrench would move the base.</p>
<img src="../../_images/sphx_glr_vis_ee_wrench_001.png" srcset="../../_images/sphx_glr_vis_ee_wrench_001.png" alt="vis ee wrench" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pytransform3d.urdf</span> <span class="kn">import</span> <span class="n">UrdfTransformManager</span>
<span class="kn">import</span> <span class="nn">pytransform3d.transformations</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="kn">import</span> <span class="nn">pytransform3d.visualizer</span> <span class="k">as</span> <span class="nn">pv</span>


<span class="k">def</span> <span class="nf">plot_screw</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">s_axis</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>
               <span class="n">h</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">A2B</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot transformation about and along screw axis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    figure : Figure</span>
<span class="sd">        Interface to Open3D&#39;s visualizer</span>

<span class="sd">    q : array-like, shape (3,), optional (default: [0, 0, 0])</span>
<span class="sd">        Vector to a point on the screw axis</span>

<span class="sd">    s_axis : array-like, shape (3,), optional (default: [1, 0, 0])</span>
<span class="sd">        Direction vector of the screw axis</span>

<span class="sd">    h : float, optional (default: 1)</span>
<span class="sd">        Pitch of the screw. The pitch is the ratio of translation and rotation</span>
<span class="sd">        of the screw axis. Infinite pitch indicates pure translation.</span>

<span class="sd">    theta : float, optional (default: 1)</span>
<span class="sd">        Rotation angle. h * theta is the translation.</span>

<span class="sd">    A2B : array-like, shape (4, 4), optional (default: I)</span>
<span class="sd">        Origin of the screw</span>

<span class="sd">    s : float, optional (default: 1)</span>
<span class="sd">        Scaling of the axis and angle that will be drawn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">pytransform3d.rotations</span> <span class="kn">import</span> <span class="p">(</span>
        <span class="n">vector_projection</span><span class="p">,</span> <span class="n">angle_between_vectors</span><span class="p">,</span> <span class="n">perpendicular_to_vectors</span><span class="p">,</span>
        <span class="n">slerp_weights</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">pytransform3d.transformations</span> <span class="kn">import</span> <span class="p">(</span>
        <span class="n">check_screw_parameters</span><span class="p">,</span> <span class="n">transform</span><span class="p">,</span> <span class="n">translate_transform</span><span class="p">,</span>
        <span class="n">vector_to_point</span><span class="p">,</span> <span class="n">vector_to_direction</span><span class="p">,</span> <span class="n">vectors_to_points</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">A2B</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">A2B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="n">q</span><span class="p">,</span> <span class="n">s_axis</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">check_screw_parameters</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">s_axis</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

    <span class="n">origin_projected_on_screw_axis</span> <span class="o">=</span> <span class="n">q</span> <span class="o">+</span> <span class="n">vector_projection</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">,</span> <span class="n">s_axis</span><span class="p">)</span>

    <span class="n">pure_translation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">pure_translation</span><span class="p">:</span>
        <span class="n">screw_axis_to_old_frame</span> <span class="o">=</span> <span class="o">-</span><span class="n">origin_projected_on_screw_axis</span>
        <span class="n">screw_axis_to_rotated_frame</span> <span class="o">=</span> <span class="n">perpendicular_to_vectors</span><span class="p">(</span>
            <span class="n">s_axis</span><span class="p">,</span> <span class="n">screw_axis_to_old_frame</span><span class="p">)</span>
        <span class="n">screw_axis_to_translated_frame</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">s_axis</span>

        <span class="n">arc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">angle_between_vectors</span><span class="p">(</span><span class="n">screw_axis_to_old_frame</span><span class="p">,</span>
                                      <span class="n">screw_axis_to_rotated_frame</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">arc</span><span class="p">)),</span>
                                  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">arc</span><span class="p">)))):</span>
            <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">t</span>
            <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">slerp_weights</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span>
            <span class="n">arc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">origin_projected_on_screw_axis</span>
                      <span class="o">+</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">screw_axis_to_old_frame</span>
                      <span class="o">+</span> <span class="n">w2</span> <span class="o">*</span> <span class="n">screw_axis_to_rotated_frame</span>
                      <span class="o">+</span> <span class="n">screw_axis_to_translated_frame</span> <span class="o">*</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">theta</span><span class="p">)</span>

    <span class="n">q</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">A2B</span><span class="p">,</span> <span class="n">vector_to_point</span><span class="p">(</span><span class="n">q</span><span class="p">))[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">s_axis</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">A2B</span><span class="p">,</span> <span class="n">vector_to_direction</span><span class="p">(</span><span class="n">s_axis</span><span class="p">))[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pure_translation</span><span class="p">:</span>
        <span class="n">arc</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">A2B</span><span class="p">,</span> <span class="n">vectors_to_points</span><span class="p">(</span><span class="n">arc</span><span class="p">))[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">origin_projected_on_screw_axis</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span>
            <span class="n">A2B</span><span class="p">,</span> <span class="n">vector_to_point</span><span class="p">(</span><span class="n">origin_projected_on_screw_axis</span><span class="p">))[:</span><span class="mi">3</span><span class="p">]</span>

    <span class="c1"># Screw axis</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">translate_transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">q</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">plot_sphere</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="n">s</span> <span class="o">*</span> <span class="mf">0.02</span><span class="p">,</span> <span class="n">A2B</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">pure_translation</span><span class="p">:</span>
        <span class="n">s_axis</span> <span class="o">*=</span> <span class="n">theta</span>
        <span class="n">Q_plus_S_axis</span> <span class="o">=</span> <span class="n">translate_transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">q</span> <span class="o">+</span> <span class="n">s_axis</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">plot_sphere</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="n">s</span> <span class="o">*</span> <span class="mf">0.02</span><span class="p">,</span> <span class="n">A2B</span><span class="o">=</span><span class="n">Q_plus_S_axis</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">s</span> <span class="o">*</span> <span class="n">s_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">s</span> <span class="o">*</span> <span class="n">s_axis</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">s</span> <span class="o">*</span> <span class="n">s_axis</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="n">s_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="n">s_axis</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="n">s_axis</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
    <span class="p">])</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">pure_translation</span><span class="p">:</span>
        <span class="c1"># Transformation</span>
        <span class="n">figure</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">arc</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]):</span>
            <span class="n">arc_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">origin_projected_on_screw_axis</span><span class="p">,</span> <span class="n">arc</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">figure</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">arc_bound</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>


<span class="n">BASE_DIR</span> <span class="o">=</span> <span class="s2">&quot;test/test_data/&quot;</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">BASE_DIR</span>
<span class="n">search_path</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>
<span class="k">while</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span> <span class="ow">and</span>
       <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">search_path</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;pytransform3d&quot;</span><span class="p">):</span>
    <span class="n">search_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">search_path</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>
    <span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">search_path</span><span class="p">,</span> <span class="n">BASE_DIR</span><span class="p">)</span>

<span class="n">tm</span> <span class="o">=</span> <span class="n">UrdfTransformManager</span><span class="p">()</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;robot_with_visuals.urdf&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">robot_urdf</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">tm</span><span class="o">.</span><span class="n">load_urdf</span><span class="p">(</span><span class="n">robot_urdf</span><span class="p">,</span> <span class="n">mesh_path</span><span class="o">=</span><span class="n">data_dir</span><span class="p">)</span>
<span class="n">tm</span><span class="o">.</span><span class="n">set_joint</span><span class="p">(</span><span class="s2">&quot;joint2&quot;</span><span class="p">,</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">tm</span><span class="o">.</span><span class="n">set_joint</span><span class="p">(</span><span class="s2">&quot;joint3&quot;</span><span class="p">,</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">tm</span><span class="o">.</span><span class="n">set_joint</span><span class="p">(</span><span class="s2">&quot;joint5&quot;</span><span class="p">,</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">tm</span><span class="o">.</span><span class="n">set_joint</span><span class="p">(</span><span class="s2">&quot;joint6&quot;</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

<span class="n">ee2base</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s2">&quot;tcp&quot;</span><span class="p">,</span> <span class="s2">&quot;robot_arm&quot;</span><span class="p">)</span>
<span class="n">base2ee</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s2">&quot;robot_arm&quot;</span><span class="p">,</span> <span class="s2">&quot;tcp&quot;</span><span class="p">)</span>

<span class="n">mass</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">wrench_in_ee</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.81</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span> <span class="o">*</span> <span class="n">mass</span>
<span class="n">wrench_in_base</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">adjoint_from_transform</span><span class="p">(</span><span class="n">base2ee</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">wrench_in_ee</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">plot_graph</span><span class="p">(</span><span class="n">tm</span><span class="p">,</span> <span class="s2">&quot;robot_arm&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">show_visuals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">plot_transform</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">plot_transform</span><span class="p">(</span><span class="n">A2B</span><span class="o">=</span><span class="n">ee2base</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">mass2base</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ee2base</span><span class="p">)</span>
<span class="n">mass2base</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.075</span>
<span class="n">fig</span><span class="o">.</span><span class="n">plot_sphere</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">A2B</span><span class="o">=</span><span class="n">mass2base</span><span class="p">)</span>

<span class="n">S</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">screw_axis_from_exponential_coordinates</span><span class="p">(</span><span class="n">wrench_in_base</span><span class="p">)</span>
<span class="n">q</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">screw_parameters_from_screw_axis</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">plot_screw</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">theta</span> <span class="o">*</span> <span class="mf">0.05</span><span class="p">)</span>

<span class="n">S</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">screw_axis_from_exponential_coordinates</span><span class="p">(</span><span class="n">wrench_in_ee</span><span class="p">)</span>
<span class="n">q</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">screw_parameters_from_screw_axis</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">plot_screw</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">theta</span> <span class="o">*</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">A2B</span><span class="o">=</span><span class="n">ee2base</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">view_init</span><span class="p">()</span>
<span class="k">if</span> <span class="s2">&quot;__file__&quot;</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">save_image</span><span class="p">(</span><span class="s2">&quot;__open3d_rendered_image.jpg&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 0.300 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-visualizations-vis-ee-wrench-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/28ffe7e5257f7fdf85f199af9a42e86a/vis_ee_wrench.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">vis_ee_wrench.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/3798b4451434f69c3dd6ad53d6084367/vis_ee_wrench.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">vis_ee_wrench.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/05926035bc21065adb961a465a8e7513/vis_ee_wrench.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">vis_ee_wrench.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014-2024, Alexander Fabisch, DFKI GmbH, Robotics Innovation Center.<br/>
      Last updated on Sep 10, 2024.<br/>
    </p>
  </div>
</footer>
  </body>
</html>