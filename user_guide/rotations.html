
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2. SO(3): 3D Rotations &#8212; pytransform3d 3.6.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=f731707b"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/rotations';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. SE(3): 3D Transformations" href="transformations.html" />
    <link rel="prev" title="1. Introduction to 3D Rigid Transformations" href="introduction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Sep 16, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="pytransform3d 3.6.1"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="pytransform3d 3.6.1"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Installation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../_auto_examples/index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Installation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../_auto_examples/index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introduction to 3D Rigid Transformations</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">2. SO(3): 3D Rotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="transformations.html">3. SE(3): 3D Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="transformation_ambiguities.html">4. Transformation Ambiguities and Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="euler_angles.html">5. Euler Angles</a></li>
<li class="toctree-l1"><a class="reference internal" href="transformation_modeling.html">6. Modeling Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="transform_manager.html">7. Managing Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="transformation_over_time.html">8. Managing Transformations over Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="camera.html">9. Camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="animations.html">10. Animations</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="so-3-3d-rotations">
<h1><span class="section-number">2. </span>SO(3): 3D Rotations<a class="headerlink" href="#so-3-3d-rotations" title="Link to this heading">#</a></h1>
<p>The group of all rotations in the 3D Cartesian space is called <span class="math notranslate nohighlight">\(SO(3)\)</span>
(SO: special orthogonal group). It is typically represented by 3D rotations
matrices <a class="footnote-reference brackets" href="#id14" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a>. The minimum number of components that are required to describe
any rotation from <span class="math notranslate nohighlight">\(SO(3)\)</span> is 3. However, there is no representation that
is non-redundant, continuous, and free of singularities. We will now take a
closer look at competing representations of rotations and the orientations they
can describe.</p>
<p>Here is an overview of the representations and the conversions between them
that are available in pytransform3d.</p>
<a class="reference internal image-reference" href="../_images/rotations.png"><img alt="Rotations" class="align-center" src="../_images/rotations.png" style="width: 50%;" /></a>
<p>Not all representations support all operations directly without conversion to
another representation. The following table is an overview. If the operation
is not implemented in pytransform3d then it is shown in brackets.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Representation</p></th>
<th class="head"><p>Inverse</p></th>
<th class="head"><p>Rotation of vector</p></th>
<th class="head"><p>Concatenation</p></th>
<th class="head"><p>Interpolation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Rotation matrix
<span class="math notranslate nohighlight">\(\pmb{R}\)</span></p></td>
<td><p>Transpose</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>Compact axis-angle
<span class="math notranslate nohighlight">\(\pmb{\omega}\)</span></p></td>
<td><p>Negative</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>(Yes) <cite>(2)</cite></p></td>
</tr>
<tr class="row-even"><td><p>Axis-angle
<span class="math notranslate nohighlight">\((\hat{\pmb{\omega}}, \theta)\)</span></p></td>
<td><p>Negative axis</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>SLERP</p></td>
</tr>
<tr class="row-odd"><td><p>Logarithm of rotation
<span class="math notranslate nohighlight">\(\left[\pmb{\omega}\right]\)</span></p></td>
<td><p>Negative</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>(Yes) <cite>(2)</cite></p></td>
</tr>
<tr class="row-even"><td><p>Quaternion
<span class="math notranslate nohighlight">\(\pmb{q}\)</span></p></td>
<td><p>Conjugate</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>SLERP</p></td>
</tr>
<tr class="row-odd"><td><p>Rotor
<span class="math notranslate nohighlight">\(R\)</span></p></td>
<td><p>Reverse</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>SLERP</p></td>
</tr>
<tr class="row-even"><td><p>Euler angles
<span class="math notranslate nohighlight">\((\alpha, \beta, \gamma)\)</span></p></td>
<td><p><cite>(1)</cite></p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>Modified Rodrigues parameters
<span class="math notranslate nohighlight">\(\psi\)</span></p></td>
<td><p>Negative</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
</tr>
</tbody>
</table>
</div>
<p>Footnotes:</p>
<p><cite>(1)</cite> Inversion of Euler angles in convention ABC (e.g., xyz) requires using
another convention CBA (e.g., zyx), reversing the order of angles, and taking
the negative of these.</p>
<p><cite>(2)</cite> Linear interpolation is approximately correct.</p>
<section id="rotation-matrix">
<h2><span class="section-number">2.1. </span>Rotation Matrix<a class="headerlink" href="#rotation-matrix" title="Link to this heading">#</a></h2>
<p>One of the most practical representations of orientation is a rotation matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}\boldsymbol R =
\left( \begin{array}{ccc}
    r_{11} &amp; r_{12} &amp; r_{13}\\
    r_{21} &amp; r_{22} &amp; r_{23}\\
    r_{31} &amp; r_{32} &amp; r_{33}\\
\end{array} \right)
\in SO(3).\end{split}\]</div>
<p>Note that this is a non-minimal representation for orientations because we
have 9 values but only 3 degrees of freedom. This is because
<span class="math notranslate nohighlight">\(\boldsymbol R\)</span> is orthonormal, which results in 6 constraints
(enforced with <a class="reference internal" href="../_apidoc/pytransform3d.rotations.norm_matrix.html#pytransform3d.rotations.norm_matrix" title="pytransform3d.rotations.norm_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">norm_matrix()</span></code></a>):</p>
<ul class="simple">
<li><p>column vectors must have unit norm (3 constraints)</p></li>
<li><p>and must be orthogonal to each other (3 constraints)</p></li>
</ul>
<p>A more compact representation of these constraints is
<span class="math notranslate nohighlight">\(\boldsymbol R^T \boldsymbol R = \boldsymbol I
\Leftrightarrow \boldsymbol R^T = \boldsymbol R^{-1}\)</span>.</p>
<p>In addition, <span class="math notranslate nohighlight">\(\det(\boldsymbol R) = 1\)</span> because we use right-handed
coordinate system (<span class="math notranslate nohighlight">\(\det(\boldsymbol R) = -1\)</span> for left-handed
coordinate systems).</p>
<p>Hence, the group <span class="math notranslate nohighlight">\(SO(3)\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[SO(3) = \{\boldsymbol{R} \in \mathbb{R}^{3 \times 3} |
\boldsymbol{R}\boldsymbol{R}^T = \boldsymbol{I},
\det(\boldsymbol{R}) = 1\}.\]</div>
<p>pytransform3d uses a numpy array of shape (3, 3) to represent rotation
matrices and typically we use the variable name R for a rotation matrix.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There are two conventions on how to interpret rotations: active
or passive rotation. The standard in pytransform3d is an active rotation.</p>
</div>
<p>We can use a rotation matrix <span class="math notranslate nohighlight">\(\boldsymbol R_{AB}\)</span> to transform a point
<span class="math notranslate nohighlight">\(_B\boldsymbol{p}\)</span> from frame <span class="math notranslate nohighlight">\(B\)</span> to frame <span class="math notranslate nohighlight">\(A\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There are two different conventions on how to use rotation matrices to
apply a rotation to a vector. We can either (pre-)multiply the rotation
matrix to a column vector from the left side or we can (post-)multiply it
to a row vector from the right side.
We will use the <strong>pre-multiplication</strong> convention.</p>
</div>
<p>This means that we rotate a point <span class="math notranslate nohighlight">\(_B\boldsymbol{p}\)</span> by</p>
<div class="math notranslate nohighlight">
\[_A\boldsymbol{p} = \boldsymbol{R}_{ABB} \boldsymbol{p}\]</div>
<p>This is called <strong>linear map</strong>.</p>
<p>Note that using our index notation and conventions the second index of the
rotation matrix and the left index of the point have to be the same. The
rotation is applied incorrectly if this is not the case.</p>
<p>We can see that <em>each column</em> of such a rotation matrix is a basis vector
of frame <span class="math notranslate nohighlight">\(A\)</span> with respect to frame <span class="math notranslate nohighlight">\(B\)</span>.
We can plot the basis vectors of an orientation to visualize it.
Here, we can see orientation represented by the rotation matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}\boldsymbol R =
\left( \begin{array}{ccc}
    1 &amp; 0 &amp; 0\\
    0 &amp; 1 &amp; 0\\
    0 &amp; 0 &amp; 1\\
\end{array} \right)\end{split}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pytransform3d.rotations</span> <span class="kn">import</span> <span class="n">plot_basis</span>
<span class="n">plot_basis</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/rotations-1.png" class="plot-directive" src="../_images/rotations-1.png" />
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When plotting basis vectors it is a convention to use red for the x-axis,
green for the y-axis and blue for the z-axis (RGB for xyz).</p>
</div>
<p>We can easily chain multiple rotations: we can apply the rotation defined
by <span class="math notranslate nohighlight">\(\boldsymbol R_{AB}\)</span> after the rotation <span class="math notranslate nohighlight">\(\boldsymbol R_{BC}\)</span>
by applying the rotation</p>
<div class="math notranslate nohighlight">
\[\boldsymbol R_{AC} = \boldsymbol R_{AB} \boldsymbol R_{BC}.\]</div>
<p>Note that again the indices have to align. Otherwise rotations are not applied
in the correct order.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There are two different conventions on how to concatenate rotation
matrices. Suppose we have a rotation matrix <span class="math notranslate nohighlight">\(R_1\)</span> and another matrix
<span class="math notranslate nohighlight">\(R_2\)</span> and we want to first rotate by <span class="math notranslate nohighlight">\(R_1\)</span> and then by
<span class="math notranslate nohighlight">\(R_2\)</span>. If we want to apply both rotations in global coordinates, we
have to concatenate them with <span class="math notranslate nohighlight">\(R_2 \cdot R_1\)</span>. We can also express
the second rotation in terms of a local, body-fixed coordinates by
<span class="math notranslate nohighlight">\(R_1 \cdot R_2\)</span>, which means <span class="math notranslate nohighlight">\(R_1\)</span> defines new coordinates in
which <span class="math notranslate nohighlight">\(R_2\)</span> is applied. Note that this applies to both
passive and active rotation matrices.</p>
</div>
<p>The easiest way to construct rotation matrices is through rotations about the
basis vectors with <a class="reference internal" href="../_apidoc/pytransform3d.rotations.active_matrix_from_angle.html#pytransform3d.rotations.active_matrix_from_angle" title="pytransform3d.rotations.active_matrix_from_angle"><code class="xref py py-func docutils literal notranslate"><span class="pre">active_matrix_from_angle()</span></code></a>.
Multiple rotation matrices that were constructed like this can be concatenated.
This will be done, for instance, to obtain rotation matrices from Euler angles
(see <a class="reference internal" href="euler_angles.html"><span class="doc">Euler Angles</span></a>).</p>
<p><strong>Pros</strong></p>
<ul class="simple">
<li><p>It is easy to apply rotations on point vectors by matrix-vector
multiplication.</p></li>
<li><p>Concatenation of rotations is trivial through matrix multiplication.</p></li>
<li><p>You can directly read the basis vectors from the columns.</p></li>
<li><p>No singularities.</p></li>
</ul>
<p><strong>Cons</strong></p>
<ul class="simple">
<li><p>We use 9 values for 3 degrees of freedom.</p></li>
<li><p>Not every 3x3 matrix is a valid rotation matrix, which means for example
that we cannot simply apply an optimization algorithm to rotation matrices
or interpolate between rotation matrices. Renormalization is
computationally expensive in comparison to quaternions.</p></li>
</ul>
</section>
<section id="axis-angle">
<h2><span class="section-number">2.2. </span>Axis-Angle<a class="headerlink" href="#axis-angle" title="Link to this heading">#</a></h2>
<figure class="align-default">
<img alt="../_images/plot_axis_angle.png" class="plot-directive" src="../_images/plot_axis_angle.png" />
</figure>
<p>Each rotation can be represented by a single rotation around one axis.
The axis can be represented as a three-dimensional unit vector and the angle
by a scalar:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left( \hat{\boldsymbol{\omega}}, \theta \right) = \left( \left( \begin{array}{c}\omega_x\\\omega_y\\\omega_z\end{array} \right), \theta \right)\end{split}\]</div>
<p>pytransform3d uses a numpy array of shape (4,) for the axis-angle
representation of a rotation, where the first 3 entries correspond to the
unit axis of rotation and the fourth entry to the rotation angle in
radians, and typically we use the variable name a.</p>
<p>Note that the axis-angle representation has a singularity at
<span class="math notranslate nohighlight">\(\theta = 0\)</span> as there is an infinite number of rotation axes that
represent the identity rotation in this case. However, we can modify the
representation to avoid this singularity.</p>
<p>It is possible to write this in a more compact way as a rotation vector <a class="footnote-reference brackets" href="#id9" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\omega} = \hat{\boldsymbol{\omega}} \theta \in \mathbb{R}^3\]</div>
<p>pytransform3d uses a numpy array of shape (3,) for the compact axis-angle
representation of a rotation and typically we use the variable name a.</p>
<p>We can also refer to this representation as <strong>exponential coordinates of
rotation</strong> <a class="footnote-reference brackets" href="#id12" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>. We can easily represent angular velocity as
<span class="math notranslate nohighlight">\(\hat{\boldsymbol{\omega}} \dot{\theta}\)</span>
and angular acceleration as
<span class="math notranslate nohighlight">\(\hat{\boldsymbol{\omega}} \ddot{\theta}\)</span> so that we can easily do
component-wise integration and differentiation with this representation.
In addition, we can represent <span class="math notranslate nohighlight">\(\hat{\boldsymbol{\omega}} \theta\)</span> by
the cross-product matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\hat{\boldsymbol{\omega}}\right] \theta
=
\left(
\begin{matrix}
0 &amp; -\omega_3 &amp; \omega_2\\
\omega_3 &amp; 0 &amp; -\omega_1\\
-\omega_2 &amp; \omega_1 &amp; 0\\
\end{matrix}
\right)
\theta
\in so(3)
\subset \mathbb{R}^{3 \times 3},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\left[\hat{\boldsymbol{\omega}}\right] \theta\)</span> is the matrix
logarithm of a rotation matrix and <span class="math notranslate nohighlight">\(so(3)\)</span> is the Lie algebra of
the Lie group <span class="math notranslate nohighlight">\(SO(3)\)</span>.</p>
<p><strong>Pros</strong></p>
<ul class="simple">
<li><p>Minimal representation (as rotation vector, also referred to as compact
axis-angle in the code).</p></li>
<li><p>Can also represent angular velocity and acceleration when we replace
<span class="math notranslate nohighlight">\(\theta\)</span> by <span class="math notranslate nohighlight">\(\dot{\theta}\)</span> or <span class="math notranslate nohighlight">\(\ddot{\theta}\)</span> respectively,
which makes numerical integration and differentiation easy.</p></li>
</ul>
<p><strong>Cons</strong></p>
<ul class="simple">
<li><p>There might be discontinuities during interpolation as an angle of 0 and
any multiple of <span class="math notranslate nohighlight">\(2\pi\)</span> represent the same orientation. This has to
be considered. Normalization is recommended.</p></li>
<li><p>When <span class="math notranslate nohighlight">\(\theta = \pi\)</span>, the axes <span class="math notranslate nohighlight">\(\hat{\boldsymbol{\omega}}\)</span> and
<span class="math notranslate nohighlight">\(-\hat{\boldsymbol{\omega}}\)</span> represent the same rotation, which is
a problem for interpolation.</p></li>
<li><p>Concatenation and transformation of vectors requires conversion to rotation
matrix or quaternion.</p></li>
</ul>
</section>
<section id="quaternions">
<h2><span class="section-number">2.3. </span>Quaternions<a class="headerlink" href="#quaternions" title="Link to this heading">#</a></h2>
<p>Quaternions are represented by a scalar / real part <span class="math notranslate nohighlight">\(w\)</span>
and an vector / imaginary part
<span class="math notranslate nohighlight">\(x \boldsymbol{i} + y \boldsymbol{j} + z \boldsymbol{k}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{q} = w + x \boldsymbol{i} + y \boldsymbol{j} + z \boldsymbol{k}
\in \mathbb{H}\]</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There are two different quaternion conventions: Hamilton’s convention
defines <span class="math notranslate nohighlight">\(ijk = -1\)</span> and the Shuster or JPL convention (from NASA’s
Jet Propulsion Laboratory, JPL) defines <span class="math notranslate nohighlight">\(ijk = 1\)</span> <a class="footnote-reference brackets" href="#id8" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.
These two conventions result in different multiplication operations and
conversions to other representations. We use Hamilton’s convention.</p>
</div>
<p>Read <a class="reference external" href="https://arxiv.org/pdf/1801.07478.pdf">this paper</a> for details about
the two conventions and why Hamilton’s convention should be used. Section VI A
gives further useful hints to identify which convention is used.</p>
<p>The unit quaternion space <span class="math notranslate nohighlight">\(\mathbb{S}^3\)</span> can be used to represent
orientations with an encoding based on the rotation axis and angle.
A rotation quaternion is a four-dimensional unit vector (versor)
<span class="math notranslate nohighlight">\(\boldsymbol{\hat{q}}\)</span>.
The following equation describes its relation to axis-axis notation.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\boldsymbol{\hat{q}} =
\left( \begin{array}{c} w\\ x\\ y\\ z\\ \end{array} \right) =
\left( \begin{array}{c}
    \cos \frac{\theta}{2}\\
    \omega_x \sin \frac{\theta}{2}\\
    \omega_y \sin \frac{\theta}{2}\\
    \omega_z \sin \frac{\theta}{2}\\
\end{array} \right)
=
\left( \begin{array}{c}
    \cos \frac{\theta}{2}\\
    \hat{\boldsymbol{\omega}} \sin \frac{\theta}{2}\\
\end{array} \right)\end{split}\]</div>
<p>pytransform3d uses a numpy array of shape (4,) for quaternions and
typically we use the variable name q.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The scalar component <span class="math notranslate nohighlight">\(w\)</span> of a quaternion is sometimes the first
element and sometimes the last element of the versor. We will use
the first element to store the scalar component.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <em>antipodal</em> unit quaternions <span class="math notranslate nohighlight">\(\boldsymbol{\hat{q}}\)</span> and
<span class="math notranslate nohighlight">\(-\boldsymbol{\hat{q}}\)</span> represent the same rotation (double cover).</p>
</div>
<p><strong>Pros</strong></p>
<ul class="simple">
<li><p>More compact than the matrix representation and less susceptible to
round-off errors.</p></li>
<li><p>The quaternion elements vary continuously over the unit sphere in
<span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span> as the orientation changes, avoiding discontinuous
jumps (inherent to three-dimensional parameterizations).</p></li>
<li><p>Expression of the rotation matrix in terms of quaternion parameters
involves no trigonometric functions.</p></li>
<li><p>Concatenation is simple and computationally cheaper with the quaternion
product than with rotation matrices.</p></li>
<li><p>No singularities.</p></li>
<li><p>Renormalization is cheap in comparison to rotation matrices: we only
have to divide by the norm of the quaternion.</p></li>
</ul>
<p><strong>Cons</strong></p>
<ul class="simple">
<li><p>The representation is not straightforward to interpret.</p></li>
<li><p>There are always two unit quaternions that represent exactly the same
rotation.</p></li>
</ul>
</section>
<section id="euler-angles">
<h2><span class="section-number">2.4. </span>Euler Angles<a class="headerlink" href="#euler-angles" title="Link to this heading">#</a></h2>
<p>A complete rotation can be split into three rotations around basis vectors.
pytransform3d uses a numpy array of shape (3,) for Euler angles, where
each entry corresponds to a rotation angle in radians around one basis
vector. The basis vector that will be used and the order of rotation
is defined by the convention that we use. See <a class="reference internal" href="euler_angles.html"><span class="doc">Euler Angles</span></a> for more
information.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There are 24 different conventions for defining euler angles. There are
12 different valid ways to sequence rotation axes that can be interpreted
as extrinsic or intrinsic rotations: XZX, XYX, YXY, YZY, ZYZ, ZXZ, XZY,
XYZ, YXZ, YZX, ZYX, and ZXY.</p>
</div>
<p><strong>Pros</strong></p>
<ul class="simple">
<li><p>Minimal representation.</p></li>
<li><p>Euler angles are easy to interpret for users (when the convention is clearly
defined) in comparison to axis-angle or quaternions.</p></li>
</ul>
<p><strong>Cons</strong></p>
<ul class="simple">
<li><p>24 different conventions.</p></li>
<li><p>Singularities (gimbal lock).</p></li>
<li><p>Concatenation and transformation of vectors requires conversion to rotation
matrix or quaternion.</p></li>
</ul>
</section>
<section id="rotors">
<h2><span class="section-number">2.5. </span>Rotors<a class="headerlink" href="#rotors" title="Link to this heading">#</a></h2>
<figure class="align-default">
<img alt="../_images/plot_bivector.png" class="plot-directive" src="../_images/plot_bivector.png" />
</figure>
<p>Rotors and quaternions are very similar concepts in 3D. However, rotors are
more general as they can be extended to more dimensions <a class="footnote-reference brackets" href="#id10" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> <a class="footnote-reference brackets" href="#id11" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.</p>
<p>The concept of a quaternion builds on the axis-angle representation, in
which we rotate by an angle about a rotation axis (see black arrow in the
illustration above). The axis can be computed from the cross product of two
vectors (gray arrow). A rotor builds on a plane-angle representation, in which
we rotate with a given direction by an angle in a plane (indicated by gray
area). The plane can be computed from the wedge product <span class="math notranslate nohighlight">\(a \wedge b\)</span> of
two vectors <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>, which is a so-called bivector. Although
both approaches might seem different, in 3D they operate with exactly the same
numbers in exactly the same way.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The rotors <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(-R\)</span> represent exactly the same rotation.</p>
</div>
<p>A rotor is a unit multivector</p>
<div class="math notranslate nohighlight">
\[R = (a, b_{yz}, b_{zx}, b_{xy})\]</div>
<p>that consists of a scalar <span class="math notranslate nohighlight">\(a\)</span> and a bivector
<span class="math notranslate nohighlight">\((b_{yz}, b_{zx}, b_{xy})\)</span>. The components of a bivector constructed
by the wedge product of two vectors can be interpreted as the area of the
parallelogram formed by the two vectors projected on the three basis planes
yz, zx, and xy (see illustration above). These values also correspond to the
x-, y-, and z-components of the cross product of the two vectors, which allows
two different interpretations of the same numbers from which we can then derive
quaternions on the one hand and rotors on the other hand.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In pytransform3d our convention is that we organize the components of a
rotor in exactly the same way as we organize the components of the
equivalent quaternion. There are other conventions. It is not just possible
to change the order of the scalar and the bivector (similar to a
quaterion), but also to change the order of bivector components.</p>
</div>
<p>Pros and cons for rotors are the same as for quaternions as they have the
same representation in 3D.</p>
</section>
<section id="modified-rodrigues-parameters">
<h2><span class="section-number">2.6. </span>Modified Rodrigues Parameters<a class="headerlink" href="#modified-rodrigues-parameters" title="Link to this heading">#</a></h2>
<p>Another minimal representation of rotation are modified Rodrigues parameters
(MRP) <a class="footnote-reference brackets" href="#id13" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a></p>
<div class="math notranslate nohighlight">
\[\psi = \tan \left(\frac{\theta}{4}\right) \hat{\boldsymbol{\omega}}\]</div>
<p>This representation is similar to the compact axis-angle representation.
However, the angle of rotation is converted to <span class="math notranslate nohighlight">\(\tan(\frac{\theta}{4})\)</span>.
Hence, there is an easy conversion from unit quaternions to MRP:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\psi = \frac{\left( \begin{array}{c} x\\ y\\ z\\ \end{array} \right)}{1 + w}.\end{split}\]</div>
<p>given some quaternion with a scalar <span class="math notranslate nohighlight">\(w\)</span> and a vector
<span class="math notranslate nohighlight">\(\left(x, y, z \right)^T\)</span>.</p>
<p>pytransform3d uses a numpy array of shape (3,) for modified Rodrigues
parameters.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>MRPs have a singuarity at <span class="math notranslate nohighlight">\(2 \pi\)</span> which we can avoid by ensuring the
angle of rotation does not exceed <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
</div>
<p><strong>Pros</strong></p>
<ul class="simple">
<li><p>Minimal representation.</p></li>
</ul>
<p><strong>Cons</strong></p>
<ul class="simple">
<li><p>The representation is not straightforward to interpret.</p></li>
<li><p>Normalization of angle required to avoid singularity.</p></li>
<li><p>Concatenation and transformation of vectors requires conversion to rotation
matrix or quaternion.</p></li>
</ul>
</section>
<section id="references">
<h2><span class="section-number">2.7. </span>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id8" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">1</a><span class="fn-bracket">]</span></span>
<p>Sommer, H., Gilitschenski, I., Bloesch, M., Weiss, S., Siegwart, R., Nieto,
J. (2018). Why and How to Avoid the Flipped Quaternion Multiplication.
Aerospace, 5(3), pp. 2226-4310, doi: 10.3390/aerospace5030072.
<a class="reference external" href="https://arxiv.org/pdf/1801.07478.pdf">https://arxiv.org/pdf/1801.07478.pdf</a></p>
</aside>
<aside class="footnote brackets" id="id9" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Gehring, C., Bellicoso, C. D., Bloesch, M., Sommer, H., Fankhauser, P.,
Hutter, M., Siegwart, R. (2024). Kindr cheat sheet.
<a class="reference external" href="https://docs.leggedrobotics.com/kindr/cheatsheet_latest.pdf">https://docs.leggedrobotics.com/kindr/cheatsheet_latest.pdf</a></p>
</aside>
<aside class="footnote brackets" id="id10" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">3</a><span class="fn-bracket">]</span></span>
<p>ten Bosch, M. (2020). Let’s remove Quaternions from every 3D Engine.
<a class="reference external" href="https://marctenbosch.com/quaternions/">https://marctenbosch.com/quaternions/</a></p>
</aside>
<aside class="footnote brackets" id="id11" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">4</a><span class="fn-bracket">]</span></span>
<p>Doran, C. (2015). Applications of Geometric Algebra.
<a class="reference external" href="http://geometry.mrao.cam.ac.uk/wp-content/uploads/2015/02/01ApplicationsI.pdf">http://geometry.mrao.cam.ac.uk/wp-content/uploads/2015/02/01ApplicationsI.pdf</a></p>
</aside>
<aside class="footnote brackets" id="id12" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">5</a><span class="fn-bracket">]</span></span>
<p>Dai, J. S. (2015). Euler–Rodrigues formula variations, quaternion
conjugation and intrinsic connections, Mechanism and Machine Theory, 92,
pp. 144-152, doi: 10.1016/j.mechmachtheory.2015.03.004.
<a class="reference external" href="https://doi.org/10.1016/j.mechmachtheory.2015.03.004">https://doi.org/10.1016/j.mechmachtheory.2015.03.004</a></p>
</aside>
<aside class="footnote brackets" id="id13" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">6</a><span class="fn-bracket">]</span></span>
<p>Terzakis, G., Lourakis, M., Ait-Boudaoud, D. (2017). Modified Rodrigues
Parameters: An Efficient Representation of Orientation in 3D Vision and
Graphics. J Math Imaging Vis, 60, pp. 422-442,
doi: 10.1007/s10851-017-0765-x.</p>
</aside>
<aside class="footnote brackets" id="id14" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">7</a><span class="fn-bracket">]</span></span>
<p>Hauser, K.: Robotic Systems (draft),
<a class="reference external" href="http://motion.pratt.duke.edu/RoboticSystems/3DRotations.html">http://motion.pratt.duke.edu/RoboticSystems/3DRotations.html</a></p>
</aside>
</aside>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="introduction.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Introduction to 3D Rigid Transformations</p>
      </div>
    </a>
    <a class="right-next"
       href="transformations.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3. </span>SE(3): 3D Transformations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotation-matrix">2.1. Rotation Matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#axis-angle">2.2. Axis-Angle</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quaternions">2.3. Quaternions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#euler-angles">2.4. Euler Angles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotors">2.5. Rotors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modified-rodrigues-parameters">2.6. Modified Rodrigues Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">2.7. References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2014-2024, Alexander Fabisch, DFKI GmbH, Robotics Innovation Center.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>